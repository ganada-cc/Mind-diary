<head>
  <link href="/css/calendar/calendar.css" rel="stylesheet">
  <link href="/css/calendar/calendar_memory.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<section id="hero" class="d-flex align-items-center"></section>
<div class="jb-division-line"></div>
<section id="hero2" class="d-flex" style="align-items: flex-start;">
  <main id="about">
    <div class="mindInputArea" style="max-width: 800px; margin: 0 auto; padding: 0 20px;">
      <div class="wrapper" style="margin-bottom: 20px;">
        <div id="slider">
          <% let link1 = '/img/nofound.png'; %>
          <% let link2 = '/img/nofound.png'; %>
          <% let link3 = '/img/nofound.png'; %>
          <% let link4 = '/img/nofound.png'; %>
          <% let link5 = '/img/nofound.png'; %>
          <% let link6 = '/img/nofound.png'; %>
          <% if (typeof(calendarResult) !== 'undefined' && calendarResult !== null ) { %>
            <% if ( calendarResult.length > 5 ) { link6 = '../uploads/' + calendarResult[calendarResult.length - 6].server_name + calendarResult[calendarResult.length - 6].extension; } %>
            <% if ( calendarResult.length > 4 ) { link5 = '../uploads/' + calendarResult[calendarResult.length - 5].server_name + calendarResult[calendarResult.length - 5].extension; } %>
            <% if ( calendarResult.length > 3 ) { link4 = '../uploads/' + calendarResult[calendarResult.length - 4].server_name + calendarResult[calendarResult.length - 4].extension; } %>
            <% if ( calendarResult.length > 2 ) { link3 = '../uploads/' + calendarResult[calendarResult.length - 3].server_name + calendarResult[calendarResult.length - 3].extension; } %>
            <% if ( calendarResult.length > 1 ) { link2 = '../uploads/' + calendarResult[calendarResult.length - 2].server_name + calendarResult[calendarResult.length - 2].extension; } %>
            <% if ( calendarResult.length > 0 ) { link1 = '../uploads/' + calendarResult[calendarResult.length - 1].server_name + calendarResult[calendarResult.length - 1].extension; } %>
          <% } %>
          <div class="slide slide1" style="background-image: url('<%= link1 %>');"></div>
          <div class="slide slide2" style="background-image: url('<%= link2 %>');"></div>
          <div class="slide slide3" style="background-image: url('<%= link3 %>');"></div>
          <div class="slide slide4" style="background-image: url('<%= link4 %>');"></div>
          <div class="slide slide5" style="background-image: url('<%= link5 %>');"></div>
          <div class="slide slide6" style="background-image: url('<%= link6 %>');"></div>
        </div>
      </div>
    
      <div id="preview-container" style="text-align:center; margin: 0 auto 20px auto;">
        <img id="preview-image" src="#" alt="pre-image" style="max-width: 300px; display: none;" />
      </div>
    
      <form id="diaryForm" action="/minddiary/minddiary-post" method="POST" enctype="multipart/form-data" style="width: 100%;">
        <script>
          const diaryQueryString = window.location.search;
          document.getElementById('diaryForm').action += diaryQueryString;
        </script>
    
        <input id="inputbox" type="file" name="file" accept="image/*" onchange="previewImage(event)" style="margin-bottom: 15px; width: 100%;">
        <input type="hidden" name="fileDate" value="<%= MindDiaryDataResult?.MindDiary_list?.date || '' %>">
    
        <table id="userDiaryForm">
          <% if (MindDiaryDataResult?.MindDiary_list) { %>
            <tr><td> 오늘의 핵심 키워드는 무엇인가요? </td></tr>
            <td><textarea name="keyword"><%= MindDiaryDataResult.MindDiary_list.keyword %></textarea></td>
            <tr><td> 오늘은 무슨 일이 일어났나요? </td></tr>
            <td><textarea name="matter"><%= MindDiaryDataResult.MindDiary_list.matter %></textarea></td>
            <tr><td> 그 일로 몸과 마음에 어떤 변화가 있었나요? </td></tr>
            <td><textarea name="change"><%= MindDiaryDataResult.MindDiary_list.change %></textarea></td>
            <tr><td> 어려운 일이 있었다면, 어떻게 해결했나요? </td></tr>
            <td><textarea name="solution"><%= MindDiaryDataResult.MindDiary_list.solution %></textarea></td>
            <tr><td> 오늘도 수고한 나 자신을 위해 칭찬 한 마디! </td></tr>
            <td><textarea name="compliment"><%= MindDiaryDataResult.MindDiary_list.compliment %></textarea></td>
          <% } else { %>
            <tr><td> 오늘의 핵심 키워드는 무엇인가요? </td></tr>
            <td><textarea name="keyword"></textarea></td>
            <tr><td> 오늘은 무슨 일이 일어났나요? </td></tr>
            <td><textarea name="matter"></textarea></td>
            <tr><td> 그 일로 몸과 마음에 어떤 변화가 있었나요? </td></tr>
            <td><textarea name="change"></textarea></td>
            <tr><td> 어려운 일이 있었다면, 어떻게 해결했나요? </td></tr>
            <td><textarea name="solution"></textarea></td>
            <tr><td> 오늘도 수고한 나 자신을 위해 칭찬 한 마디! </td></tr>
            <td><textarea name="compliment"></textarea></td>
          <% } %>
        </table>
    
        <div class="submitt_btn">
          <button class="mindBtn" type="submit">저장</button>
        </div>
      </form>
    </div>
  </main>

  <script>
    function previewImage(event) {
      const file = event.target.files[0];
      const preview = document.getElementById('preview-image');
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          preview.src = e.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        preview.src = '#';
        preview.style.display = 'none';
      }
    }

    const otherMLinks = document.getElementsByClassName("nav-linkM");
    const calendarMLinks = document.getElementsByClassName("calendaractiveM");
    for (const link of otherMLinks) link.classList.remove("activeM");
    for (const link of calendarMLinks) link.classList.add("activeM");
  </script>
</section>
